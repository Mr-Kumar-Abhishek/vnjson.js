{"version":3,"sources":["icaro.js","navigo.js","vnjson.js","plugins/get-screens.js","plugins/jump.js","plugins/router.js","plugins/screen-show.js","plugins/vnjson-audio.js","plugins/vnjson-preload.js"],"names":["global","factory","exports","module","define","amd","icaro","setImmediate","tasksByHandle","nextHandle","currentlyRunningATask","registerImmediate","callback","clearImmediate","handle","runIfPresent","setTimeout","task","installNextTickImplementation","process","nextTick","installPostMessageImplementation","messagePrefix","Math","random","onGlobalMessage","event","source","data","indexOf","slice","length","addEventListener","postMessage","toString","call","self","window","listeners","WeakMap","dispatch","Symbol","isIcaro","timer","isArray","changes","API","listen","fn","type","has","set","get","push","unlisten","callbacks","index","splice","toJSON","Object","keys","reduce","ret","key","value","ICARO_HANDLER","target","property","obj","defineProperty","enumerable","configurable","writable","enhance","assign","Map","forEach","clear","bind","Array","item","i","Proxy","create","Navigo","_typeof","iterator","constructor","prototype","isPushStateAvailable","history","pushState","r","useHash","hash","root","_routes","_useHash","_hash","_paused","_destroyed","_lastRouteResolved","_notFoundHandler","_defaultHandler","_usePushState","_onLocationChange","_genericHooks","_historyAPIUpdateMethod","replace","_cLoc","split","_listen","updatePageLinks","clean","s","RegExp","regExpResultToParams","match","names","params","decodeURIComponent","replaceDynamicURLParts","route","paramNames","regexp","PARAMETER_REGEXP","full","dots","name","REPLACE_VARIABLE_REGEXP","WILDCARD_REGEXP","REPLACE_WILDCARD","FOLLOWED_BY_SLASH_REGEXP","MATCH_REGEXP_FLAGS","getUrlDepth","url","compareUrlDepth","urlA","urlB","findMatchedRoutes","routes","arguments","undefined","map","_replaceDynamicURLPar","filter","m","matched","fallbackURL","result","isHashChangeAPIAvailable","extractGETParameters","join","getOnlyURL","onlyURL","cleanGETParam","str","manageHooks","handler","hooks","before","shouldRoute","after","isHashedRoot","helpers","navigate","path","absolute","to","_getRoot","resolve","location","href","on","_this","_len","args","_key","func","uses","_add","orderedRoutes","sort","off","notFound","current","_this2","GETParameters","query","already","_callLeave","apply","destroy","clearTimeout","_listeningInterval","removeEventListener","document","_findLinks","link","hasListenerAttached","e","getLinkPath","preventDefault","generate","pause","status","resume","historyAPIUpdateMethod","disableIfAPINotAvailable","lastRouteResolved","getAttribute","_hooks","encodeURI","as","_this3","cached","_check","check","__NAVIGO_WINDOW_LOCATION_MOCK__","querySelectorAll","leave","vnjs","plugins","TREE","DEBUG","playList","prevAudio","prevScreen","screenList","emit","state","scene","label","screens","object","setScene","body","characters","aliase","character","reply","param","assets","parse","ctx","next","init","conf","fetchCss","filename","l","createElement","rel","h","getElementsByTagName","appendChild","uriHtml","gameDir","uriCss","gameRoot","querySelector","element","fetch","then","text","innerHTML","screensNodeList","screenClass","screen","styles","display","width","height","style","setAttribute","id","console","log","pathname","getScene","sceneName","labelName","uri","scenesDir","local","json","sceneBody","isScene","pathName","arr","isNaN","warn","isLabel","router","info","jump","getRealDisplay","elem","currentStyle","getComputedStyle","computedStyle","getPropertyValue","hide","el","displayCache","isHidden","offsetWidth","offsetHeight","tr","nodeName","toLowerCase","show","old","testElem","removeChild","pscreen","play","action","error","persent","PROGREESS","asset","position","progress","round","img","Image","src","onload","audio","Audio"],"mappings":"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","file":"vnjson.js","sourcesContent":["(function (global, factory) {\r\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\r\n  typeof define === 'function' && define.amd ? define(factory) :\r\n  (global.icaro = factory());\r\n}(this, (function () { 'use strict';\r\n\r\n// fork of https://github.com/YuzuJS/setImmediate\r\n((function (global) {\r\n  if (global.setImmediate) {\r\n    return\r\n  }\r\n\r\n  const tasksByHandle = {};\r\n\r\n  let nextHandle = 1; // Spec says greater than zero\r\n  let currentlyRunningATask = false;\r\n  let registerImmediate;\r\n\r\n  function setImmediate(callback) {\r\n    tasksByHandle[nextHandle] = callback;\r\n    registerImmediate(nextHandle);\r\n    return nextHandle++\r\n  }\r\n\r\n  function clearImmediate(handle) {\r\n    delete tasksByHandle[handle];\r\n  }\r\n\r\n  function runIfPresent(handle) {\r\n    // From the spec: \"Wait until any invocations of this algorithm started before this one have completed.\"\r\n    // So if we're currently running a task, we'll need to delay this invocation.\r\n    if (currentlyRunningATask) {\r\n      // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\r\n      // \"too much recursion\" error.\r\n      setTimeout(runIfPresent, 0, handle);\r\n    } else {\r\n      const task = tasksByHandle[handle];\r\n      if (task) {\r\n        currentlyRunningATask = true;\r\n        try {\r\n          task();\r\n        } finally {\r\n          clearImmediate(handle);\r\n          currentlyRunningATask = false;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  function installNextTickImplementation() {\r\n    registerImmediate = handle => {\r\n      process.nextTick(() => { runIfPresent(handle); });\r\n    };\r\n  }\r\n\r\n  function installPostMessageImplementation() {\r\n    // Installs an event handler on `global` for the `message` event: see\r\n    // * https://developer.mozilla.org/en/DOM/window.postMessage\r\n    // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages\r\n    const messagePrefix = `setImmediate$${Math.random()}$`;\r\n    const onGlobalMessage = event => {\r\n      if (event.source === global &&\r\n                typeof event.data === 'string' &&\r\n                event.data.indexOf(messagePrefix) === 0) {\r\n        runIfPresent(+event.data.slice(messagePrefix.length));\r\n      }\r\n    };\r\n\r\n    global.addEventListener('message', onGlobalMessage, false);\r\n\r\n    registerImmediate = handle => {\r\n      global.postMessage(messagePrefix + handle, '*');\r\n    };\r\n  }\r\n\r\n  // Don't get fooled by e.g. browserify environments.\r\n  if ({}.toString.call(global.process) === '[object process]') {\r\n    // For Node.js before 0.9\r\n    installNextTickImplementation();\r\n  } else {\r\n    // For non-IE10 modern browsers\r\n    installPostMessageImplementation();\r\n  }\r\n\r\n  global.setImmediate = setImmediate;\r\n  global.clearImmediate = clearImmediate;\r\n\r\n}))(typeof self === 'undefined' ? typeof global === 'undefined' ? window : global : self);\r\n\r\nconst listeners = new WeakMap();\r\nconst dispatch = Symbol();\r\nconst isIcaro = Symbol();\r\nconst timer = Symbol();\r\nconst isArray = Symbol();\r\nconst changes = Symbol();\r\n\r\n/**\r\n * Public api\r\n * @type {Object}\r\n */\r\nconst API = {\r\n  /**\r\n   * Set a listener on any object function or array\r\n   * @param   {Function} fn - callback function associated to the property to listen\r\n   * @returns {API}\r\n   */\r\n  listen(fn) {\r\n    const type = typeof fn;\r\n    if(type !== 'function')\r\n      throw `The icaro.listen method accepts as argument \"typeof 'function'\", \"${type}\" is not allowed`\r\n\r\n    if (!listeners.has(this)) listeners.set(this, []);\r\n    listeners.get(this).push(fn);\r\n\r\n    return this\r\n  },\r\n\r\n  /**\r\n   * Unsubscribe to a property previously listened or to all of them\r\n   * @param   {Function} fn - function to unsubscribe\r\n   * @returns {API}\r\n   */\r\n  unlisten(fn) {\r\n    const callbacks = listeners.get(this);\r\n    if (!callbacks) return\r\n    if (fn) {\r\n      const index = callbacks.indexOf(fn);\r\n      if (~index) callbacks.splice(index, 1);\r\n    } else {\r\n      listeners.set(this, []);\r\n    }\r\n\r\n    return this\r\n  },\r\n\r\n  /**\r\n   * Convert the icaro object into a valid JSON object\r\n   * @returns {Object} - simple json object from a Proxy\r\n   */\r\n  toJSON() {\r\n    return Object.keys(this).reduce((ret, key) => {\r\n      const value = this[key];\r\n      ret[key] = value && value.toJSON ? value.toJSON() : value;\r\n      return ret\r\n    }, this[isArray] ? [] : {})\r\n  }\r\n};\r\n\r\n/**\r\n * Icaro proxy handler\r\n * @type {Object}\r\n */\r\nconst ICARO_HANDLER = {\r\n  set(target, property, value) {\r\n    // filter the values that didn't change\r\n    if (target[property] !== value) {\r\n      if (value === Object(value) && !value[isIcaro]) {\r\n        target[property] = icaro(value);\r\n      } else {\r\n        target[property] = value;\r\n      }\r\n      target[dispatch](property, value);\r\n    }\r\n\r\n    return true\r\n  }\r\n};\r\n\r\n/**\r\n * Define a private property\r\n * @param   {*} obj - receiver\r\n * @param   {String} key - property name\r\n * @param   {*} value - value to set\r\n */\r\nfunction define(obj, key, value) {\r\n  Object.defineProperty(obj, key, {\r\n    value:  value,\r\n    enumerable: false,\r\n    configurable: false,\r\n    writable: false\r\n  });\r\n}\r\n\r\n/**\r\n * Enhance the icaro objects adding some hidden props to them and the API methods\r\n * @param   {*} obj - anything\r\n * @returns {*} the object received enhanced with some extra properties\r\n */\r\nfunction enhance(obj) {\r\n  // add some \"kinda hidden\" properties\r\n  Object.assign(obj, {\r\n    [changes]: new Map(),\r\n    [timer]: null,\r\n    [isIcaro]: true,\r\n    [dispatch](property, value) {\r\n      if (listeners.has(obj)) {\r\n        clearImmediate(obj[timer]);\r\n        obj[changes].set(property, value);\r\n        obj[timer] = setImmediate(function() {\r\n          listeners.get(obj).forEach(function(fn) {fn(obj[changes]);});\r\n          obj[changes].clear();\r\n        });\r\n      }\r\n    }\r\n  });\r\n\r\n  // Add the API methods bound to the original object\r\n  Object.keys(API).forEach(function(key) {\r\n    define(obj, key, API[key].bind(obj));\r\n  });\r\n\r\n  // remap values and methods\r\n  if (Array.isArray(obj)) {\r\n    obj[isArray] = true;\r\n    // remap the initial array values\r\n    obj.forEach(function(item, i) {\r\n      obj[i] = null; // force a reset\r\n      ICARO_HANDLER.set(obj, i, item);\r\n    });\r\n  }\r\n\r\n  return obj\r\n}\r\n\r\n/**\r\n * Factory function\r\n * @param   {*} obj - anything can be an icaro Proxy\r\n * @returns {Proxy}\r\n */\r\nfunction icaro(obj) {\r\n  return new Proxy(\r\n    enhance(obj || {}),\r\n    Object.create(ICARO_HANDLER)\r\n  )\r\n}\r\n\r\nreturn icaro;\r\n\r\n})));","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.Navigo = factory());\n}(this, (function () { 'use strict';\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nfunction isPushStateAvailable() {\n  return !!(typeof window !== 'undefined' && window.history && window.history.pushState);\n}\n\nfunction Navigo(r, useHash, hash) {\n  this.root = null;\n  this._routes = [];\n  this._useHash = useHash;\n  this._hash = typeof hash === 'undefined' ? '#' : hash;\n  this._paused = false;\n  this._destroyed = false;\n  this._lastRouteResolved = null;\n  this._notFoundHandler = null;\n  this._defaultHandler = null;\n  this._usePushState = !useHash && isPushStateAvailable();\n  this._onLocationChange = this._onLocationChange.bind(this);\n  this._genericHooks = null;\n  this._historyAPIUpdateMethod = 'pushState';\n\n  if (r) {\n    this.root = useHash ? r.replace(/\\/$/, '/' + this._hash) : r.replace(/\\/$/, '');\n  } else if (useHash) {\n    this.root = this._cLoc().split(this._hash)[0].replace(/\\/$/, '/' + this._hash);\n  }\n\n  this._listen();\n  this.updatePageLinks();\n}\n\nfunction clean(s) {\n  if (s instanceof RegExp) return s;\n  return s.replace(/\\/+$/, '').replace(/^\\/+/, '^/');\n}\n\nfunction regExpResultToParams(match, names) {\n  if (names.length === 0) return null;\n  if (!match) return null;\n  return match.slice(1, match.length).reduce(function (params, value, index) {\n    if (params === null) params = {};\n    params[names[index]] = decodeURIComponent(value);\n    return params;\n  }, null);\n}\n\nfunction replaceDynamicURLParts(route) {\n  var paramNames = [],\n      regexp;\n\n  if (route instanceof RegExp) {\n    regexp = route;\n  } else {\n    regexp = new RegExp(route.replace(Navigo.PARAMETER_REGEXP, function (full, dots, name) {\n      paramNames.push(name);\n      return Navigo.REPLACE_VARIABLE_REGEXP;\n    }).replace(Navigo.WILDCARD_REGEXP, Navigo.REPLACE_WILDCARD) + Navigo.FOLLOWED_BY_SLASH_REGEXP, Navigo.MATCH_REGEXP_FLAGS);\n  }\n  return { regexp: regexp, paramNames: paramNames };\n}\n\nfunction getUrlDepth(url) {\n  return url.replace(/\\/$/, '').split('/').length;\n}\n\nfunction compareUrlDepth(urlA, urlB) {\n  return getUrlDepth(urlB) - getUrlDepth(urlA);\n}\n\nfunction findMatchedRoutes(url) {\n  var routes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n\n  return routes.map(function (route) {\n    var _replaceDynamicURLPar = replaceDynamicURLParts(clean(route.route)),\n        regexp = _replaceDynamicURLPar.regexp,\n        paramNames = _replaceDynamicURLPar.paramNames;\n\n    var match = url.replace(/^\\/+/, '/').match(regexp);\n    var params = regExpResultToParams(match, paramNames);\n\n    return match ? { match: match, route: route, params: params } : false;\n  }).filter(function (m) {\n    return m;\n  });\n}\n\nfunction match(url, routes) {\n  return findMatchedRoutes(url, routes)[0] || false;\n}\n\nfunction root(url, routes) {\n  var matched = routes.map(function (route) {\n    return route.route === '' || route.route === '*' ? url : url.split(new RegExp(route.route + '($|\\/)'))[0];\n  });\n  var fallbackURL = clean(url);\n\n  if (matched.length > 1) {\n    return matched.reduce(function (result, url) {\n      if (result.length > url.length) result = url;\n      return result;\n    }, matched[0]);\n  } else if (matched.length === 1) {\n    return matched[0];\n  }\n  return fallbackURL;\n}\n\nfunction isHashChangeAPIAvailable() {\n  return typeof window !== 'undefined' && 'onhashchange' in window;\n}\n\nfunction extractGETParameters(url) {\n  return url.split(/\\?(.*)?$/).slice(1).join('');\n}\n\nfunction getOnlyURL(url, useHash, hash) {\n  var onlyURL = url,\n      split;\n  var cleanGETParam = function cleanGETParam(str) {\n    return str.split(/\\?(.*)?$/)[0];\n  };\n\n  if (typeof hash === 'undefined') {\n    // To preserve BC\n    hash = '#';\n  }\n\n  if (isPushStateAvailable() && !useHash) {\n    onlyURL = cleanGETParam(url).split(hash)[0];\n  } else {\n    split = url.split(hash);\n    onlyURL = split.length > 1 ? cleanGETParam(split[1]) : cleanGETParam(split[0]);\n  }\n\n  return onlyURL;\n}\n\nfunction manageHooks(handler, hooks, params) {\n  if (hooks && (typeof hooks === 'undefined' ? 'undefined' : _typeof(hooks)) === 'object') {\n    if (hooks.before) {\n      hooks.before(function () {\n        var shouldRoute = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n\n        if (!shouldRoute) return;\n        handler();\n        hooks.after && hooks.after(params);\n      }, params);\n      return;\n    } else if (hooks.after) {\n      handler();\n      hooks.after && hooks.after(params);\n      return;\n    }\n  }\n  handler();\n}\n\nfunction isHashedRoot(url, useHash, hash) {\n  if (isPushStateAvailable() && !useHash) {\n    return false;\n  }\n\n  if (!url.match(hash)) {\n    return false;\n  }\n\n  var split = url.split(hash);\n\n  return split.length < 2 || split[1] === '';\n}\n\nNavigo.prototype = {\n  helpers: {\n    match: match,\n    root: root,\n    clean: clean,\n    getOnlyURL: getOnlyURL\n  },\n  navigate: function navigate(path, absolute) {\n    var to;\n\n    path = path || '';\n    if (this._usePushState) {\n      to = (!absolute ? this._getRoot() + '/' : '') + path.replace(/^\\/+/, '/');\n      to = to.replace(/([^:])(\\/{2,})/g, '$1/');\n      history[this._historyAPIUpdateMethod]({}, '', to);\n      this.resolve();\n    } else if (typeof window !== 'undefined') {\n      path = path.replace(new RegExp('^' + this._hash), '');\n      window.location.href = window.location.href.replace(/#$/, '').replace(new RegExp(this._hash + '.*$'), '') + this._hash + path;\n    }\n    return this;\n  },\n  on: function on() {\n    var _this = this;\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    if (typeof args[0] === 'function') {\n      this._defaultHandler = { handler: args[0], hooks: args[1] };\n    } else if (args.length >= 2) {\n      if (args[0] === '/') {\n        var func = args[1];\n\n        if (_typeof(args[1]) === 'object') {\n          func = args[1].uses;\n        }\n\n        this._defaultHandler = { handler: func, hooks: args[2] };\n      } else {\n        this._add(args[0], args[1], args[2]);\n      }\n    } else if (_typeof(args[0]) === 'object') {\n      var orderedRoutes = Object.keys(args[0]).sort(compareUrlDepth);\n\n      orderedRoutes.forEach(function (route) {\n        _this.on(route, args[0][route]);\n      });\n    }\n    return this;\n  },\n  off: function off(handler) {\n    if (this._defaultHandler !== null && handler === this._defaultHandler.handler) {\n      this._defaultHandler = null;\n    } else if (this._notFoundHandler !== null && handler === this._notFoundHandler.handler) {\n      this._notFoundHandler = null;\n    }\n    this._routes = this._routes.reduce(function (result, r) {\n      if (r.handler !== handler) result.push(r);\n      return result;\n    }, []);\n    return this;\n  },\n  notFound: function notFound(handler, hooks) {\n    this._notFoundHandler = { handler: handler, hooks: hooks };\n    return this;\n  },\n  resolve: function resolve(current) {\n    var _this2 = this;\n\n    var handler, m;\n    var url = (current || this._cLoc()).replace(this._getRoot(), '');\n\n    if (this._useHash) {\n      url = url.replace(new RegExp('^\\/' + this._hash), '/');\n    }\n\n    var GETParameters = extractGETParameters(current || this._cLoc());\n    var onlyURL = getOnlyURL(url, this._useHash, this._hash);\n\n    if (this._paused) return false;\n\n    if (this._lastRouteResolved && onlyURL === this._lastRouteResolved.url && GETParameters === this._lastRouteResolved.query) {\n      if (this._lastRouteResolved.hooks && this._lastRouteResolved.hooks.already) {\n        this._lastRouteResolved.hooks.already(this._lastRouteResolved.params);\n      }\n      return false;\n    }\n\n    m = match(onlyURL, this._routes);\n\n    if (m) {\n      this._callLeave();\n      this._lastRouteResolved = {\n        url: onlyURL,\n        query: GETParameters,\n        hooks: m.route.hooks,\n        params: m.params,\n        name: m.route.name\n      };\n      handler = m.route.handler;\n      manageHooks(function () {\n        manageHooks(function () {\n          m.route.route instanceof RegExp ? handler.apply(undefined, m.match.slice(1, m.match.length)) : handler(m.params, GETParameters);\n        }, m.route.hooks, m.params, _this2._genericHooks);\n      }, this._genericHooks, m.params);\n      return m;\n    } else if (this._defaultHandler && (onlyURL === '' || onlyURL === '/' || onlyURL === this._hash || isHashedRoot(onlyURL, this._useHash, this._hash))) {\n      manageHooks(function () {\n        manageHooks(function () {\n          _this2._callLeave();\n          _this2._lastRouteResolved = { url: onlyURL, query: GETParameters, hooks: _this2._defaultHandler.hooks };\n          _this2._defaultHandler.handler(GETParameters);\n        }, _this2._defaultHandler.hooks);\n      }, this._genericHooks);\n      return true;\n    } else if (this._notFoundHandler) {\n      manageHooks(function () {\n        manageHooks(function () {\n          _this2._callLeave();\n          _this2._lastRouteResolved = { url: onlyURL, query: GETParameters, hooks: _this2._notFoundHandler.hooks };\n          _this2._notFoundHandler.handler(GETParameters);\n        }, _this2._notFoundHandler.hooks);\n      }, this._genericHooks);\n    }\n    return false;\n  },\n  destroy: function destroy() {\n    this._routes = [];\n    this._destroyed = true;\n    this._lastRouteResolved = null;\n    this._genericHooks = null;\n    clearTimeout(this._listeningInterval);\n    if (typeof window !== 'undefined') {\n      window.removeEventListener('popstate', this._onLocationChange);\n      window.removeEventListener('hashchange', this._onLocationChange);\n    }\n  },\n  updatePageLinks: function updatePageLinks() {\n    var self = this;\n\n    if (typeof document === 'undefined') return;\n\n    this._findLinks().forEach(function (link) {\n      if (!link.hasListenerAttached) {\n        link.addEventListener('click', function (e) {\n          var location = self.getLinkPath(link);\n\n          if (!self._destroyed) {\n            e.preventDefault();\n            self.navigate(location.replace(/\\/+$/, '').replace(/^\\/+/, '/'));\n          }\n        });\n        link.hasListenerAttached = true;\n      }\n    });\n  },\n  generate: function generate(name) {\n    var data = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    var result = this._routes.reduce(function (result, route) {\n      var key;\n\n      if (route.name === name) {\n        result = route.route;\n        for (key in data) {\n          result = result.toString().replace(':' + key, data[key]);\n        }\n      }\n      return result;\n    }, '');\n\n    return this._useHash ? this._hash + result : result;\n  },\n  link: function link(path) {\n    return this._getRoot() + path;\n  },\n  pause: function pause() {\n    var status = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n\n    this._paused = status;\n    if (status) {\n      this._historyAPIUpdateMethod = 'replaceState';\n    } else {\n      this._historyAPIUpdateMethod = 'pushState';\n    }\n  },\n  resume: function resume() {\n    this.pause(false);\n  },\n  historyAPIUpdateMethod: function historyAPIUpdateMethod(value) {\n    if (typeof value === 'undefined') return this._historyAPIUpdateMethod;\n    this._historyAPIUpdateMethod = value;\n    return value;\n  },\n  disableIfAPINotAvailable: function disableIfAPINotAvailable() {\n    if (!isPushStateAvailable()) {\n      this.destroy();\n    }\n  },\n  lastRouteResolved: function lastRouteResolved() {\n    return this._lastRouteResolved;\n  },\n  getLinkPath: function getLinkPath(link) {\n    return link.getAttribute('href');\n  },\n  hooks: function hooks(_hooks) {\n    this._genericHooks = _hooks;\n  },\n\n  _add: function _add(route) {\n    var handler = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    var hooks = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n    if (typeof route === 'string') {\n      route = encodeURI(route);\n    }\n    this._routes.push((typeof handler === 'undefined' ? 'undefined' : _typeof(handler)) === 'object' ? {\n      route: route,\n      handler: handler.uses,\n      name: handler.as,\n      hooks: hooks || handler.hooks\n    } : { route: route, handler: handler, hooks: hooks });\n\n    return this._add;\n  },\n  _getRoot: function _getRoot() {\n    if (this.root !== null) return this.root;\n    this.root = root(this._cLoc().split('?')[0], this._routes);\n    return this.root;\n  },\n  _listen: function _listen() {\n    var _this3 = this;\n\n    if (this._usePushState) {\n      window.addEventListener('popstate', this._onLocationChange);\n    } else if (isHashChangeAPIAvailable()) {\n      window.addEventListener('hashchange', this._onLocationChange);\n    } else {\n      var cached = this._cLoc(),\n          current = void 0,\n          _check = void 0;\n\n      _check = function check() {\n        current = _this3._cLoc();\n        if (cached !== current) {\n          cached = current;\n          _this3.resolve();\n        }\n        _this3._listeningInterval = setTimeout(_check, 200);\n      };\n      _check();\n    }\n  },\n  _cLoc: function _cLoc() {\n    if (typeof window !== 'undefined') {\n      if (typeof window.__NAVIGO_WINDOW_LOCATION_MOCK__ !== 'undefined') {\n        return window.__NAVIGO_WINDOW_LOCATION_MOCK__;\n      }\n      return clean(window.location.href);\n    }\n    return '';\n  },\n  _findLinks: function _findLinks() {\n    return [].slice.call(document.querySelectorAll('[data-navigo]'));\n  },\n  _onLocationChange: function _onLocationChange() {\n    this.resolve();\n  },\n  _callLeave: function _callLeave() {\n    var lastRouteResolved = this._lastRouteResolved;\n\n    if (lastRouteResolved && lastRouteResolved.hooks && lastRouteResolved.hooks.leave) {\n      lastRouteResolved.hooks.leave(lastRouteResolved.params);\n    }\n  }\n};\n\nNavigo.PARAMETER_REGEXP = /([:*])(\\w+)/g;\nNavigo.WILDCARD_REGEXP = /\\*/g;\nNavigo.REPLACE_VARIABLE_REGEXP = '([^\\/]+)';\nNavigo.REPLACE_WILDCARD = '(?:.*)';\nNavigo.FOLLOWED_BY_SLASH_REGEXP = '(?:\\/$|$)';\nNavigo.MATCH_REGEXP_FLAGS = '';\n\nreturn Navigo;\n\n})));\n","\r\nvar vnjs = {\r\n  \r\n      plugins: {},\r\n      TREE: {},\r\n      DEBUG: false,\r\n      playList: {},\r\n      prevAudio: \"\",\r\n      prevScreen: \"\",\r\n      screenList: {}\r\n};\r\n\r\nvnjs.on = function(event, handler){\r\n          if (!vnjs.plugins[event]) {\r\n              vnjs.plugins[event] = [];\r\n          };\r\n          vnjs.plugins[event].push(handler);\r\n};\r\n\r\nvnjs.emit = function (event, ...args) {\r\n         if (Array.isArray(vnjs.plugins[event])) {\r\n            vnjs.plugins[event].map(function(handler){\r\n                    handler.call(vnjs, ...args);\r\n            });\r\n         }\r\n         /*\r\n         else{\r\n          Выводятся системные слушатели\r\n          console.log(`Event [ ${event} ] not found`)\r\n         }\r\n         */\r\n};\r\nvnjs.off = function (event) {\r\n        delete vnjs.plugins[event];\r\n};\r\n\r\n/*\r\n * В {state} должно помещаться все то\r\n * что сохроняется в карту памяти\r\n * И что важно загрузить из нее без последствий.\r\n * В состоянии не должно быть мусора\r\n */\r\n\r\nvnjs.state = {\r\n  scene: 'scene',\r\n  label: 'label',\r\n  index: 0,\r\n  \r\n  screens: []//заменить массив строкой.\r\n};\r\n\r\n\r\n/*\r\n * Получает текущее тела из состояние\r\n */\r\nvnjs.current = {\r\n  \r\n      scene: function (){\r\n        return vnjs.TREE[vnjs.state.scene];\r\n      },\r\n      label: function (){\r\n        return vnjs.TREE[vnjs.state.scene][vnjs.state.label];\r\n      },\r\n      object: function (){\r\n        return vnjs.TREE[vnjs.state.scene][vnjs.state.label][vnjs.state.index];\r\n     }\r\n};\r\n\r\n\r\nvnjs.setScene = function (name, body){\r\n  this.TREE[name] = body;\r\n  this.state.scene = name;\r\n\r\n  body.characters.map(character=>{\r\n    let aliase = Object.keys(character)[0];\r\n\r\n    vnjs.on(aliase, function(reply){\r\n          vnjs.emit('character', {aliase, param: character[aliase], reply } );\r\n\r\n    });\r\n\r\n});\r\n  this.emit('load', body.assets);\r\n // this.parse();//??? Возможно это будет вызываться не здесь\r\n};\r\n\r\n\r\n\r\n\r\nvnjs.parse = function (obj){\r\n  var ctx = null;\r\n  if(obj){\r\n    ctx = obj;\r\n  }else{\r\n    ctx = vnjs.current.object();\r\n  };\r\n\r\n  for(let event in ctx){\r\n\r\n        vnjs.emit(event, ctx[event]);\r\n\r\n  };\r\n\r\n};\r\n\r\n\r\nvnjs.next = function (){\r\n  this.parse();\r\n  this.state.index++;\r\n  return '-------------------------';\r\n};\r\n\r\nvnjs.init = function (conf){\r\n  vnjs.conf = conf;\r\n // this.parse({'jump': conf.entryScene});\r\n  vnjs.emit('getScreens');\r\n  return true;\r\n};\r\n","vnjs.on('getScreens', function(){\r\n\r\nconst { conf, DEBUG, emit } = this;\r\n\r\nfunction fetchCss(filename) {\r\n    var l = document.createElement('link');\r\n    l.rel = 'stylesheet';\r\n    l.href = filename\r\n    var h = document.getElementsByTagName('head')[0];\r\n    h.appendChild(l);\r\n};\r\n\r\n\r\n\r\n\t\r\n\tlet uriHtml = `${conf.gameDir}/screens.html`;\r\n\tlet uriCss = `${conf.gameDir}/screens.css`;\r\n\tlet gameRoot = document.querySelector(conf.element);\r\n\tfetch(uriHtml)\r\n\t\t.then(r=>r.text())\r\n\t\t\r\n\t\t.then(screens=>{\r\n\t\t\tfetchCss(uriCss);\r\n\t\t\tgameRoot.innerHTML = screens;\r\n\t\t})\r\n\t\t.then(()=>{\r\n\t\t\tlet screensNodeList = document.querySelectorAll(conf.screenClass);\r\n            screensNodeList.forEach((screen)=>{\r\n\r\n             let styles = {\r\n                    display: 'none',\r\n                    width: '100%',\r\n                    height: '100%'\r\n                  };\r\n             Object.assign(screen.style, styles);\r\n\r\n             /*Код кантораЮ необходимо для работы 'Правильлного show/hide'*/\r\n\t\t\tscreen.setAttribute(\"displayOld\", screen.style.display)\r\n             \r\n\r\n            vnjs.screenList[screen.id] = screen;\r\n            \r\n            DEBUG&&console.log(screen);\r\n            \r\n            });\r\n\r\n          emit('screensLoaded')\r\n\t\t})\r\n\t\t//.catch(function(error) { console.error(error); })\r\n\t\t\r\n})","vnjs.on('jump', function(pathname){\r\n\r\nconst { parse,  emit, DEBUG, conf, setScene } = this;\r\n\r\nfunction getScene(data){\r\n  const { sceneName, labelName, index } = data;\r\n\r\n  let uri = `${conf.gameDir}/${conf.scenesDir}/${conf.local}/${sceneName}.json`;\r\n  emit('preload', data);\r\n  fetch(uri)\r\n  .then(r=>r.json())\r\n  .then(sceneBody=>{\r\n\r\n    if(DEBUG){\r\n      console.log(sceneName, sceneBody)\r\n    //  console.log(data);\r\n    }\r\n\r\n    vnjs.setScene(sceneName, sceneBody, labelName, index);\r\n\r\n  });\r\n/*\r\n\r\nsetScene(\"*\", sceneBody);\r\n\r\nstate.label = \"mainMenu\";\r\n\r\nnext();\r\n*/\r\n\r\n}\r\n\r\nfunction isScene(pathName){\r\n  var arr = pathName.split('/');\r\n  /*\r\n      scene/label/index\r\n  */\r\n  if(arr.length===3){\r\n    if( isNaN(+arr[2]) ){\r\n      console.warn('scene/label/index')\r\n      console.warn('Index should be a Number');\r\n      vnjs.state.index = 0;\r\n    }\r\n    \r\n    return true;\r\n  }\r\n  /*\r\n      scene/label\r\n  */\r\n  else if(arr.length===2){\r\n    var isLabel = false;\r\n     /*  scene/label  */\r\n    if( isNaN(+arr[1]) ){\r\n      isLabel = true;\r\n    }\r\n    /*  label/index  */\r\n    else {\r\n      isLabel = false;\r\n    }\r\n   \r\n    return isLabel;\r\n  }\r\n \r\n};\r\n\r\n  var arr = pathname.split('/');\r\n\r\nif(isScene(pathname)){\r\n    // set state\r\n    vnjs.state.scene = arr[0];\r\n    vnjs.state.label = arr[1];\r\n    vnjs.state.index = arr[2]||0;\r\n   getScene({ sceneName:  arr[0], labelName:  arr[1], index:  vnjs.state.index });\r\n}else{\r\n\r\n\t // set state\r\n   // vnjs.state.scene = vnjs.state.scene;\r\n    vnjs.state.label = arr[1];\r\n    vnjs.state.index = arr[2]||0;\r\n\r\n   // setLabel(pathname, ctx.scene[pathname],  obj.num );\r\n   parse();\r\n}\r\n\r\n\r\n\r\n});\r\n\r\n\r\n","{\r\n\tlet root = null;\r\n\tvnjs.router = new Navigo(root, true, '#!');\r\n};\r\n\r\nvnjs.router\r\n  .on(function(){\r\n    console.info('############ vnjson.js #############');\r\n    vnjs.parse({screen: 'main-menu'})\r\n  })\r\n  .on('/about', function(){\r\n    vnjs.parse({screen: 'about'})\r\n  })\r\n  .on('/settings', function(){\r\n    vnjs.parse({screen: 'settings'})\r\n  })\r\n\r\n  .on('/game/:scene', function(params){\r\n  \tlet { scene } = params;\r\n\r\n    console.warn([scene].join('|'))\r\n  })\r\n  .on('/game/:scene/:label', function(params){\r\n  \tlet { scene, label } = params;\r\n    vnjs.parse({\r\n            jump: [ scene, label ].join('/')\r\n          })\r\n    \r\n  })\r\n  .on('/game/:scene/:label/:index', function (params) {\r\n//router.navigate('/products/list');\r\n    let { scene, label, index } = params;\r\n    console.warn([scene,label, index].join('|'))\r\n  })\r\n  .notFound(function(){\r\n  \tconsole.warn('Маршрута не существует')\r\n  })\r\n  .resolve();\r\n\r\n\r\n","/**\r\n\r\n\r\n\r\nПлагины\r\nget-screens\r\n &\r\nscreen-show\r\nобъеденить в один ->screen\r\n\r\n* Так же можно было бы объеденить jump и getScenes\r\n*\r\n*/\r\nfunction getRealDisplay(elem) {\r\n\tif (elem.currentStyle) {\r\n\t\treturn elem.currentStyle.display\r\n\t} else if (window.getComputedStyle) {\r\n\t\tvar computedStyle = window.getComputedStyle(elem, null )\r\n\r\n\t\treturn computedStyle.getPropertyValue('display')\r\n\t}\r\n}\r\n\r\nfunction hide(el) {\r\n\tif (!el.getAttribute('displayOld')) {\r\n\t\tel.setAttribute(\"displayOld\", el.style.display)\r\n\t}\r\n\r\n\tel.style.display = \"none\"\r\n}\r\n\r\ndisplayCache = {}\r\n\r\nfunction isHidden(el) {\r\n\tvar width = el.offsetWidth, height = el.offsetHeight,\r\n\t\ttr = el.nodeName.toLowerCase() === \"tr\"\r\n\r\n\treturn width === 0 && height === 0 && !tr ?\r\n\t\ttrue : width > 0 && height > 0 && !tr ? false :\tgetRealDisplay(el)\r\n}\r\n\r\n\r\n\r\nfunction show(el) {\r\n\r\n\tif (getRealDisplay(el) != 'none') return\r\n\r\n\tvar old = el.getAttribute(\"displayOld\");\r\n\tel.style.display = old || \"\";\r\n\r\n\tif ( getRealDisplay(el) === \"none\" ) {\r\n\t\tvar nodeName = el.nodeName, body = document.body, display\r\n\r\n\t\tif ( displayCache[nodeName] ) {\r\n\t\t\tdisplay = displayCache[nodeName]\r\n\t\t} else {\r\n\t\t\tvar testElem = document.createElement(nodeName)\r\n\t\t\tbody.appendChild(testElem)\r\n\t\t\tdisplay = getRealDisplay(testElem)\r\n\r\n\t\t\tif (display === \"none\" ) {\r\n\t\t\t\tdisplay = \"block\"\r\n\t\t\t}\r\n\r\n\t\t\tbody.removeChild(testElem)\r\n\t\t\tdisplayCache[nodeName] = display\r\n\t\t}\r\n\r\n\t\tel.setAttribute('displayOld', display)\r\n\t\tel.style.display = display\r\n\t}\r\n}\r\n\r\n\r\n\r\n\r\nvnjs.on('screen', function(id){\r\n\tthis.emit(id, vnjs.screenList[id]);\r\n\r\n\r\n if(vnjs.prevScreen!=\"\"){\r\n \t\t\t\tlet pscreen = vnjs.screenList[vnjs.prevScreen];\r\n         hide(pscreen);\r\n        \r\n }\r\n\r\n vnjs.prevScreen = id;\r\n\t//prefix\r\n\t//show.id\r\n\t//hide.pref.screen\r\n\t//push.state.screens\r\n\tshow(vnjs.screenList[id])\r\n})","\r\n\r\nvnjs.on('audio', function(data){\r\n\r\n\r\n\r\n  if(typeof data === 'string'){\r\n      \r\n       if(vnjs.prevAudio!=\"\"){\r\n         vnjs.playList[vnjs.prevAudio].pause();\r\n       }\r\n       vnjs.playList[data].play(); \r\n       vnjs.prevAudio = data;\r\n\r\n  }else if(typeof data === 'object'){\r\n\r\n      if(vnjs.prevAudio!=\"\"){\r\n          vnjs.playList[vnjs.prevAudio].pause();\r\n       }\r\n\r\n      vnjs.playList[data.id][data.action]();\r\n    \r\n       vnjs.prevAudio = data.id;\r\n     // vnjs.audio[data.id].loop = data.loop;\r\n  }else{\r\n    console.error('incorect data type');\r\n  }\r\n//var sound = self.playlist[self.index].howl;\r\n\r\n});","/* @events\r\n    * preload\r\n    * load\r\n    * postload\r\n */\r\n\r\nvnjs.on('load', function(assets){\r\n  const { DEBUG, emit } = this;\r\n\r\n\r\nvar persent = 100/assets.length;\r\nvar PROGREESS = 0;\r\nvar i = 0;\r\nfor(let asset of assets){\r\n \r\nvar position = [ i+=1, '/', assets.length ].join(\"\");\r\n\r\nlet progress = Math.round(PROGREESS+=persent)+\"%\";\r\n\r\n\r\n  if(asset.type===\"image\"){\r\n       let img = new Image();\r\n           img.src = asset.path;\r\n           img.onload = function(){\r\n                 emit('imageLoad', asset);\r\n           };\r\n  }\r\n  else if(asset.type===\"audio\"){\r\n       let audio = new Audio();\r\n           audio.addEventListener('canplaythrough', ()=>{\r\n                  emit('audioLoad', asset);\r\n           }, false);\r\n          audio.src = asset.path;\r\n        vnjs.playList[asset.id] = audio; \r\n  }\r\n  else{\r\n    console.error('asset type incorect');\r\n    break;\r\n  }\r\nlet data = Object.assign(asset, {progress, position});\r\n                  emit('asset', data);\r\n};\r\n\r\n{\r\n  DEBUG&&console.info('LOADING...');\r\n};\r\n\r\n\r\n  emit('postload');\r\n});\r\n\r\n\r\n\r\n\r\n\r\n\r\n"]}