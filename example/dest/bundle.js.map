{"version":3,"sources":["main-menu/index.js","vnjson-alias/index.js","vnjson-get-scene/index.js","vnjson-jump/index.js","vnjson-preload/index.js","vnjson-screen/index.js"],"names":["vnjs","on","parse","alert","document","getElementById","addEventListener","e","preventDefault","next","obj","console","log","character","name","reply","getScene","sceneName","labelName","ctx","setScene","get","emit","config","qwest","scenesDir","responseType","then","req","res","label","pathname","setLabel","util","game","isScene","test","splitPathName","num","scene","labels","assets","forEach","item","info","setTimeout","style","display","screensPath","body","querySelector","el","innerHTML","response","jump","startLabel","catch","err","error","screens","id","push","length","prev","prevScreen","screensPrefix","screen"],"mappings":"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","file":"bundle.js","sourcesContent":["vnjs.on('main-menu', function(){\r\n        this.parse({alert: 'kasin++'})\r\n        document\r\n          .getElementById('start-game')\r\n          .addEventListener('mousedown', function(e){\r\n            e.preventDefault();\r\n            vnjs.parse({'jump': 'chapter1'})\r\n            vnjs.next();\r\n\r\n          })\r\n});","vnjs.on('alias', function(obj){\n\n  console.log(obj.character.name+\": \"+obj.reply);\n  \n});","vnjs.getScene = function(sceneName, labelName){\n      let { ctx, setScene, get, emit, config} = vnjs;\n      emit('preload');\n      qwest\n        .get(config.scenesDir+sceneName+\".json\", {responseType: 'json'})\n        .then(function(req, res){\n                  ctx.label = labelName;\n                  setScene(sceneName, res);\n         });\n};\n\n\n\n","/*\n * @ deps getScene\n */\nvnjs.on('jump', function(pathname){\n  let {\n        ctx, \n        next, \n        setScene, \n        setLabel, \n        util, \n        game, \n        parse, \n        getScene, \n        emit\n      } = this;\n\n  let isScene = /\\/\\w+/gi.test(pathname);\n  if(isScene){\n    let obj = util.splitPathName(pathname);\n    console.log(pathname);\n    ctx.num = 0;\n    getScene(obj.scene, obj.label);\n  }else{\n\n\n   ctx.num = 0;\n   setLabel(pathname, ctx.scene.labels[pathname] );\n\n   parse();\n  }\n});","vnjs.on('preload', function(){\r\n  this.parse({\r\n        \"screen\": \"preloader\"\r\n      });\r\n\r\n})\r\nvnjs.on('setscene', function(){\r\n    let { emit, game, ctx } = this;\r\n\r\n  ctx.scene.assets.forEach((item)=>{\r\n    console.info(item)\r\n  });\r\n  emit('load');\r\n});\r\n\r\nvnjs.on('load', function(){\r\n  setTimeout(function(){\r\n    document.getElementById('vnjson__preloader').style.display = \"none\";\r\n  }, 3000);\r\n});","\r\n\r\nvnjs.on('init', function(){\r\n  let { config, parse, emit } = this;\r\n  qwest.get(config.screensPath, { responseType: 'html' })\r\n      .then(function(body){\r\n         document\r\n            .querySelector(config.el)\r\n            .innerHTML = body.response;\r\n\r\n            parse({ jump: config.startLabel });\r\n      }).catch(function(err){\r\n        console.error(err);\r\n      });\r\n\r\n});\r\n\r\n\r\nvnjs.screens = [];\r\nvnjs.on('screen', function(id){\r\n    let { config, parse, emit } = this;\r\n      this.screens.push( id )\r\n\r\n\r\n      if(this.screens.length>=2){\r\n          let prev = this.screens[this.screens.length-2];\r\n\r\n             var prevScreen = document.getElementById(config.screensPrefix+prev);\r\n           prevScreen.style.display = \"none\";\r\n      }\r\n      var screen = document.getElementById(config.screensPrefix+id);\r\n      screen.style.display = \"block\";\r\n      emit(id, {id});\r\n\r\n});\r\n\r\n\r\n\r\n"]}