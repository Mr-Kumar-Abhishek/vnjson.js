{"version":3,"sources":["main-menu/index.js","vnjson-alias/index.js","vnjson-get-scene/index.js","vnjson-jump/index.js","vnjson-preload/index.js","vnjson-screen/index.js"],"names":["vnjs","on","parse","alert","document","getElementById","addEventListener","e","preventDefault","next","obj","console","log","character","name","reply","ctx","setScene","setLabel","emit","config","qwest","get","scenesDir","sceneName","responseType","then","req","res","labelName","pathname","game","getScene","isScene","test","getName","pathArr","split","scene","label","num","assets","forEach","item","info","setTimeout","style","display","screensPath","body","querySelector","el","innerHTML","response","jump","startLabel","catch","err","error","screens","id","push","length","prev","prevScreen","screensPrefix","screen"],"mappings":"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","file":"bundle.js","sourcesContent":["vnjs.on('main-menu', function(){\r\n        this.parse({alert: 'kasin++'})\r\n        document\r\n          .getElementById('start-game')\r\n          .addEventListener('mousedown', function(e){\r\n            e.preventDefault();\r\n            vnjs.parse({'jump': 'chapter1'})\r\n            vnjs.next();\r\n\r\n          })\r\n});","vnjs.on('alias', function(obj){\n\n  console.log(obj.character.name+\": \"+obj.reply);\n  \n});","\nvnjs.on('getscene', function(obj){\n    let { ctx, setScene, setLabel, emit, config} = this;\n      emit('preload');\n      qwest\n        .get(config.scenesDir+obj.sceneName+\".json\", { responseType: 'json' })\n        .then(function(req, res){\n                  setLabel(obj.labelName, []);\n                  setScene(sceneName, res);\n         });\n})","\r\nvnjs.on('jump', function(pathname){\r\n  let {\r\n        ctx, \r\n        next, \r\n        setScene, \r\n        setLabel, \r\n        game, \r\n        parse, \r\n        getScene, \r\n        emit\r\n      } = this;\r\nlet isScene = /\\/\\w+/gi.test(pathname);\r\n\r\nfunction getName(pathname){\r\n  let pathArr = pathname.split('/');\r\n  let scene = pathArr[0];\r\n  let label = pathArr[1];\r\n  return { label, scene };\r\n};\r\n\r\n  \r\nif(isScene){\r\n    let obj = getName(pathname);\r\n    ctx.num = 0;\r\n    emit('getscene', {labelName: obj.label, sceneName: obj.scene});\r\n}else{\r\n    ctx.num = 0;\r\n    setLabel(pathname, ctx.scene[pathname] );\r\n    parse();\r\n  }\r\n});","vnjs.on('preload', function(){\r\n  this.parse({\r\n        \"screen\": \"preloader\"\r\n      });\r\n\r\n})\r\nvnjs.on('setscene', function(){\r\n    let { emit, game, ctx } = this;\r\n\r\n  ctx.scene.assets.forEach((item)=>{\r\n    console.info(item)\r\n  });\r\n  emit('load');\r\n});\r\n\r\nvnjs.on('load', function(){\r\n  setTimeout(function(){\r\n    document.getElementById('vnjson__preloader').style.display = \"none\";\r\n  }, 3000);\r\n});","\r\n\r\nvnjs.on('init', function(){\r\n  let { config, parse, emit } = this;\r\n  qwest.get(config.screensPath, { responseType: 'html' })\r\n      .then(function(body){\r\n         document\r\n            .querySelector(config.el)\r\n            .innerHTML = body.response;\r\n\r\n            parse({ jump: config.startLabel });\r\n      }).catch(function(err){\r\n        console.error(err);\r\n      });\r\n\r\n});\r\n\r\n\r\nvnjs.screens = [];\r\nvnjs.on('screen', function(id){\r\n    let { config, parse, emit } = this;\r\n      this.screens.push( id )\r\n\r\n\r\n      if(this.screens.length>=2){\r\n          let prev = this.screens[this.screens.length-2];\r\n\r\n             var prevScreen = document.getElementById(config.screensPrefix+prev);\r\n           prevScreen.style.display = \"none\";\r\n      }\r\n      var screen = document.getElementById(config.screensPrefix+id);\r\n      screen.style.display = \"block\";\r\n      emit(id, {id});\r\n\r\n});\r\n\r\n\r\n\r\n"]}